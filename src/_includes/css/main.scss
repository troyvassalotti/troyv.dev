@use "_mixins";
@import "_fonts";

html {
  /* FONT SIZING */
  /* @link https://utopia.fyi/type/calculator?c=320,21,1.2,1600,24,1.25,5,2,&s=0.75|0.5|0.25,1.5|2|3|4|6,s-l */
  --step--2: clamp(0.78rem, calc(0.77rem + 0.07vw), 0.84rem);
  --step--1: clamp(0.94rem, calc(0.91rem + 0.14vw), 1.05rem);
  --step-0: clamp(1.13rem, calc(1.08rem + 0.23vw), 1.31rem);
  --step-1: clamp(1.35rem, calc(1.28rem + 0.36vw), 1.64rem);
  --step-2: clamp(1.62rem, calc(1.51rem + 0.54vw), 2.05rem);
  --step-3: clamp(1.94rem, calc(1.79rem + 0.78vw), 2.56rem);
  --step-4: clamp(2.33rem, calc(2.11rem + 1.09vw), 3.2rem);
  --step-5: clamp(2.8rem, calc(2.5rem + 1.51vw), 4.01rem);
  --step-6: clamp(3rem, calc(3.25rem + 2.25vw), 5.72rem);
  --step-7: clamp(4.7rem, calc(4.09rem + 3.06vw), 7.15rem);
  --step-8: clamp(5.64rem, calc(4.82rem + 4.12vw), 8.94rem);
  --step-9: clamp(6.77rem, calc(5.67rem + 5.5vw), 11.18rem);
  --step-10: clamp(8.13rem, calc(6.67rem + 7.3vw), 13.97rem);

  /* SPACING */
  /* @link https://utopia.fyi/space/calculator?c=320,18,1.2,1600,21,1.25,5,2,&s=0.75|0.5|0.25,1.5|2|3|4|6,s-l */
  --space-3xs: clamp(0.31rem, calc(0.31rem + 0vw), 0.31rem);
  --space-2xs: clamp(0.56rem, calc(0.53rem + 0.16vw), 0.69rem);
  --space-xs: clamp(0.88rem, calc(0.84rem + 0.16vw), 1rem);
  --space-s: clamp(1.13rem, calc(1.08rem + 0.23vw), 1.31rem);
  --space-m: clamp(1.69rem, calc(1.61rem + 0.39vw), 2rem);
  --space-l: clamp(2.25rem, calc(2.16rem + 0.47vw), 2.63rem);
  --space-xl: clamp(3.38rem, calc(3.23rem + 0.7vw), 3.94rem);
  --space-2xl: clamp(4.5rem, calc(4.31rem + 0.94vw), 5.25rem);
  --space-3xl: clamp(6.75rem, calc(6.47rem + 1.41vw), 7.88rem);

  /* ONE-UP PAIRS */
  --space-3xs-2xs: clamp(0.31rem, calc(0.22rem + 0.47vw), 0.69rem);
  --space-2xs-xs: clamp(0.56rem, calc(0.45rem + 0.55vw), 1rem);
  --space-xs-s: clamp(0.88rem, calc(0.77rem + 0.55vw), 1.31rem);
  --space-s-m: clamp(1.13rem, calc(0.91rem + 1.09vw), 2rem);
  --space-m-l: clamp(1.69rem, calc(1.45rem + 1.17vw), 2.63rem);
  --space-l-xl: clamp(2.25rem, calc(1.83rem + 2.11vw), 3.94rem);
  --space-xl-2xl: clamp(3.38rem, calc(2.91rem + 2.34vw), 5.25rem);
  --space-2xl-3xl: clamp(4.5rem, calc(3.66rem + 4.22vw), 7.88rem);

  /* CUSTOM PAIRS */
  --space-s-l: clamp(1.13rem, calc(0.75rem + 1.88vw), 2.63rem);

  /* FONT FAMILIES */
  --body: Inter, Roboto, "Helvetica Neue", "Arial Nova", "Nimbus Sans", Arial, sans-serif;
  --code: "Native", monospace;
  --headings: var(--body);

  /* COLOR PALETTE */
  --light: #fff8f0;
  --dark: #252422;
  --accent: #0075f2;
  --sunset: #ffcf99;
  --blue: #0077b6;

  --links: var(--primary);

  /* STANDARD RULES */
  accent-color: var(--accent);
  background-color: var(--background);
  color: var(--foreground);
  scrollbar-gutter: stable;
}

/* COLOR SCHEME CHANGES */
@media (prefers-color-scheme: light) {
  html {
    --background: var(--light);
    --foreground: var(--dark);
    --primary: var(--blue);
  }
}

@media (prefers-color-scheme: dark) {
  html {
    --background: var(--dark);
    --foreground: var(--light);
    --primary: var(--sunset);
  }

  pre {
    font-weight: 300;
  }

  .u-invertSvg--onDark svg {
    filter: invert(1);
  }
}

.js :is(type-writer):not(:defined) {
  visibility: hidden;
}

modal-menu:not(:defined) {
  display: none;
}

body {
  font-family: var(--body);
  font-size: var(--step-0);
}

.code,
code,
pre {
  font-family: var(--code);
}

pre {
  font-size: var(--step--2);
  white-space: pre-wrap;
}

button {
  appearance: none;
  background: transparent;
  border: 0;
  cursor: pointer;
}

:is(h1, h2, h3, h4, h5, h6) {
  font-family: var(--headings);
  line-height: 1.1;
}

h1 {
  font-size: var(--step-5);
}

h2 {
  font-size: var(--step-4);
}

h3 {
  font-size: var(--step-3);
}

h4 {
  font-size: var(--step-2);
}

h5 {
  font-size: var(--step-1);
}

h6 {
  font-size: var(--step-0);
}

blockquote {
  border: var(--space-3xs) solid var(--accent);
  box-shadow: var(--space-2xs) var(--space-2xs) 0 0 var(--accent);
  font-style: italic;
  inline-size: fit-content;
  margin-block: var(--space-s-m);
  position: relative;
}

blockquote :is(p, q) {
  padding-block: var(--space-s);
  padding-inline: var(--space-xs-s);
}

figcaption {
  font-size: var(--step--1);
  margin-block-start: 1em;
}

sup {
  vertical-align: top;
}

a {
  color: var(--links);
}

a:hover,
a:focus {
  filter: brightness(0.7);
}

a:focus-visible {
  outline: 2px dashed var(--links);
  outline-offset: 2px;
}

.wrapper {
  inline-size: min(100% - var(--wrapper-padding, 2rem), var(--wrapper-size, 100rem));
  margin-inline: auto;
}

.wrapper.constrain--some {
  --wrapper-size: 81.25rem;
}

.wrapper.constrain--more {
  --wrapper-size: 68.75rem;
}

.wrapper.constrain--most {
  --wrapper-size: 41.5rem;
}

.wrapper.constrain--less {
  --wrapper-size: 115rem;
}

.wrapper.constrain--base {
  --wrapper-size: 100rem;
}

.defaultContentBlock,
.addLayoutMargin {
  margin-block-end: var(--space-xl);
}

.visually-hidden:not(:focus):not(:active) {
  block-size: 1px;
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  inline-size: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
}

/* Create equal spacing between elements in a flow context without setting display */
.flow > *:not(style, script) + *:not(style, script) {
  margin-block-start: var(--flow-space, 1em);
}

/* OBJECTS */
.o-section--angled {
  --clip-point: calc(var(--section-padding) / 2);
  --section-background: var(--foreground);
  --section-padding: 10vh;
  background: var(--section-background);
  clip-path: polygon(0 var(--clip-point), 100% 0%, 100% calc(100% - var(--clip-point)), 0% 100%);
  color: var(--background);
  padding-block: var(--section-padding);
  padding-inline: var(--space-s-m);
}

.o-section--angled a {
  color: currentColor;
}

/* COMPONENTS */
.c-animatedLink {
  --linkStateRest: scaleX(1);
  --linkStartRest: left;
  --linkStateHover: scaleX(0);
  --linkStartHover: right;
  text-decoration: underline;
}

.c-postListItem {
  --flow-space: var(--space-2xs);
}

.c-postListItem__date {
  font-size: var(--step--1);
  font-style: italic;
}

.c-postListItem__title {
  font-size: var(--step-3);
}

@media (prefers-reduced-motion: no-preference) {
  .c-animatedLink {
    position: relative;
    text-decoration: none;
  }

  .c-animatedLink::before {
    background-color: currentColor;
    block-size: 0.06em;
    content: "";
    inline-size: 100%;
    inset-block-end: 0;
    inset-inline-start: 0;
    position: absolute;
    transform: var(--linkStateRest);
    transform-origin: var(--linkStartRest);
    transition: transform 400ms ease-out;
  }

  .c-animatedLink:hover::before {
    transform: var(--linkStateHover);
    transform-origin: var(--linkStartHover);
  }
}

.c-link--icon svg {
  display: inline-block;
  margin-inline-end: var(--space-2xs);
  max-inline-size: 1.5em;
  vertical-align: middle;
}

.c-svg-link {
  display: block;
  max-inline-size: 3em;
}

.bandcampEmbed {
  block-size: var(--embed-h, 750px);
  border: 0;
  inline-size: min(var(--embed-h, 100%), 100%);
}

.releaseGrid {
  --column-count: auto-fill;
  --column-size: 9rem;

  align-items: start;
  display: grid;
  font-size: var(--step--1);
  grid-template-columns: repeat(var(--column-count), minmax(var(--column-size), 1fr));
  gap: var(--space-s-l);
  margin-block-end: var(--space-xl-2xl);
}

@media (min-width: 70.25rem) {
  .releaseGrid {
    --column-count: 5;
    --column-size: 12rem;
  }
}

.releaseName {
  font-weight: bold;
  text-transform: uppercase;
}

.releaseListens,
.releaseArtist {
  font-size: var(--step--2);
}

.release {
  display: flex;
  flex-direction: column;
  justify-content: end;
}

.releaseArt {
  aspect-ratio: 1 / 1;
  background: radial-gradient(var(--background), var(--foreground));
  margin-block-end: var(--space-xs);
}

/* UTILITIES */
.u-step-10 {
  font-size: var(--step-10);
}

.u-step-9 {
  font-size: var(--step-9);
}

.u-step-8 {
  font-size: var(--step-8);
}

.u-step-7 {
  font-size: var(--step-7);
}

.u-step-6 {
  font-size: var(--step-6);
}

.u-step-5 {
  font-size: var(--step-5);
}

.u-step-4 {
  font-size: var(--step-4);
}

.u-step-3 {
  font-size: var(--step-3);
}

.u-step-2 {
  font-size: var(--step-2);
}

.u-step-1 {
  font-size: var(--step-1);
}

.u-step-0 {
  font-size: var(--step-0);
}

.u-step--1 {
  font-size: var(--step--1);
}

.u-step--2 {
  font-size: var(--step--2);
}

.u-text--center {
  text-align: center;
}

.u-truncate :is(p, ul, ol) {
  max-inline-size: var(--readable-length, 70ch);
}

.u-line-height--less {
  line-height: 1.25;
}

.u-text--caps {
  text-transform: uppercase;
}

.u-text--italic {
  font-style: italic;
}

.u-text--bold {
  font-weight: bold;
}

.u-font--headings {
  font-family: var(--headings);
}

.u-font--base {
  font-family: var(--body);
}

.u-font--code {
  font-family: var(--code);
}

.u-revertMargin--start {
  margin-block-start: revert;
}

.u-revertMargin--end {
  margin-block-end: revert;
}

.u-breakout {
  margin-inline: calc(50% - 50vw);
}

/* Yeah you do */
.u-rule {
  margin-block-start: var(--space-l-xl);
  max-inline-size: 40ch;
}

.u-grid {
  display: grid;
  gap: var(--grid-gap, var(--space-m));
}

[data-grid-columns="2"] {
  grid-template-columns: repeat(2, 1fr);
}

[data-grid-columns="3"] {
  grid-template-columns: repeat(3, 1fr);
}

[data-grid-columns="fluid"] {
  grid-template-columns: repeat(var(--fluid-type, auto-fit), minmax(var(--fluid-col-size, 200px), 1fr));
}

.button,
beats-per button,
.detune__note,
.detune__playAll {
  @include mixins.button;
}

.detune__notes {
  --input-gap: 1em;
  --input-size: 4em;

  align-items: start;
  block-size: calc(calc(var(--input-size) * 3) + calc(var(--input-gap) * 3));
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  gap: var(--input-gap);
  inline-size: calc(calc(var(--input-size) * 2) + calc(var(--input-gap) * 2));
  justify-content: center;
}

.detune__note,
.detune__playAll {
  block-size: var(--input-size);
  inline-size: var(--input-size);
}
