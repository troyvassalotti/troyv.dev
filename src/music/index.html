{% extends 'layouts/page.html' %}

<script type="module">
    {% set js %}
    import plvylist from 'https://cdn.skypack.dev/plvylist';

    // This is for the handdrawn annotations from Rough Notation
    import {annotate} from "https://cdn.skypack.dev/rough-notation"

    let mq = "(prefers-color-scheme: dark)"

    const pageTitle = document.querySelector("#page-title")

    const changeTitleColor = () => {
        matchMedia(mq).matches ? pageTitle.setAttribute("style", "color: var(--blackPrimary)") : pageTitle.setAttribute("style", "color: var(--whitePrimary)")
    }

    window.matchMedia(mq).addEventListener("change", changeTitleColor())
    const musicAnnotation = annotate(pageTitle, {
        type: "highlight",
        color: "var(--musicColor)",
        padding: 15
    })

    musicAnnotation.show()
    {% endset %}
</script>

{% block main %}
<div class="page-layout">
    <section class="bands-container">
        <div class="wrapper">
            <div class="content center">
                <section class="section-header">
                    <p>
                        I write for a few projects, so here they are with all the important links.
                        Music is best managed elsewhere than my personal website, so you're better
                        off visiting those places.
                    </p>
                </section>
                <section class="bands">
                    <div class="band">
                        <div class="band-logo">
                            <a href="https://www.frontroyalband.com/">
                                <img
                                    src="{{ metadata.cloudinary }}/c_scale,f_auto,q_auto:eco,w_400/v1646349103/blog/front-royal-logo-white_400x240_fharjl.webp"
                                    alt="Front Royal"
                                    width="400"
                                    height="240"
                                    class="full"
                                    loading="lazy"
                                    decoding="async" />
                            </a>
                        </div>
                        <div class="icon-bar">
                            {% for social in frontRoyalSocial %}
                            <a class="icon-link" href="{{ social.href }}">
                                {% include "partials/" + social.img %}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="band">
                        <div class="band-logo">
                            <a href="https://music.troyvassalotti.xyz/">
                                <img
                                    src="{{ metadata.cloudinary }}/c_scale,f_auto,q_auto:eco,w_300/v1646349104/blog/troy-full_jx1oq4.webp"
                                    alt="troy"
                                    width="300"
                                    height="150"
                                    loading="lazy"
                                    decoding="async"
                                    class="full" />
                            </a>
                        </div>
                        <div class="icon-bar">
                            {% for social in troySocial %}
                            <a class="icon-link" href="{{ social.href }}">
                                {% include "partials/" + social.img %}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </section>
    <section class="music-player">
        <div class="wrapper" data-constrain="more">
            <header class="center">
                <h2>Stream <span class="italic" id="album-title">Alone In A Crowded Room</span></h2>
                <p>
                    I <a href="/posts/plvylist-web-component">created my own</a> embedded streaming
                    player, called
                    <a href="https://github.com/troyvassalotti/plvylist" class="italic">Plvylist</a
                    >. Check it out!
                </p>
            </header>
            <plvylist-player tracks="/alone-in-a-crowded-room.json" starting-volume="0.75">
            </plvylist-player>
        </div>
    </section>
</div>
{% endblock %}

<style>
    {% set css %}
    .page-layout {
        display: flex;
        flex-wrap: wrap;
        gap: 3rem;
        justify-content: center;
    }

    .page-layout > * {
        flex: 1 1 max-content;
    }

    :is(.music-player header, .bands-container .section-header) p {
        margin-inline: auto;
        max-inline-size: 60ch;
    }

    .bands {
        align-items: flex-end;
        display: flex;
        flex-wrap: wrap;
        row-gap: 2rem;
    }

    .band {
        display: flex;
        flex: 1 1 auto;
        flex-direction: column;
    }

    .band-logo img {
        filter: invert(1);
        max-inline-size: 15rem;
        transition: opacity .1s ease;
    }

    .icon-bar {
        align-items: center;
        display: flex;
        gap: 1.5rem;
        margin: auto;
        max-inline-size: max-content;
    }

    .icon-link {
        flex: 1;
    }

    .icon-bar svg {
        max-inline-size: 48px;
        transition: opacity .1s ease;
    }

    :is(.icon-bar, .band-logo) :is(img, svg):hover {
        opacity: .5;
    }

    @media (prefers-color-scheme: dark) {
        .band-logo img {
            filter: none;
        }

        .icon-bar svg {
            filter: invert(1);
        }
    }

    {% endset %}
</style>
